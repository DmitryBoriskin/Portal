@using System.Security.Claims
@using PgDbase.entity

@model UsersViewModel

@{
    Layout = "~/Areas/Admin/Views/Shared/_popUp.cshtml";
}

@if (User.Identity.HasClaim(ClaimTypes.Role, "Developer") || User.Identity.HasClaim(ClaimTypes.Role, "PortalAdmin") || User.Identity.HasClaim(ClaimTypes.Role, "SiteAdmin"))
{
    using (Html.BeginForm())
    {
        <div class="row" style="min-height:550px;">
            <div class="col-xs-10">
                <div class="description">* Поиск пользователей производится только в рамках сайта</div>
                <div class="form-group">
                    <label>Пользователь:</label>
                </div>
                <select id="siteUser-select" class="form-control"></select>
            </div>
            <div class="col-xs-6">
                <div class="form-group" style="margin-bottom: 0;">
                    <label>Роль:</label>
                </div>
                <select id="siteUserRole-select" class="form-control">
                    @if (Model.Roles != null && Model.Roles.Count() > 0)
                    {
                        foreach (var role in Model.Roles)
                        {
                            if (Model.Item != null && Model.Item.Roles != null && Model.Item.Roles.Any(m => m.Name == role.Name))
                            {
                                <option value="@role.Name" disabled>@role.Desc</option>
                            }
                            else
                            {
                                <option value="@role.Name">@role.Desc</option>
                            }
                        }
                    }
                </select>

            </div>
            <div class="col-xs-4">
                <button type="button" id="add-newSiteAdmin-btn" style="margin-top: 25px;" class="button icon-create green pull-right" data-url="/admin/roles/addUserRole">Добавить</button>
            </div>
        </div>
    }
}
else
{
    <div class="content"><p>У вас недостаточно прав.</p></div>
}

<script>
    $(document).ready(function () {
        $("#siteUserRole-select").select2();
    });
</script>
